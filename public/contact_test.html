<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>NotEqualZero(≠0)Inc.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="NotEqualZero(≠0)Inc.のご紹介" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div id="container">
      <header>
        <h1 id="logo"><img src="images/nez_logo.png" alt="notequalzero" /></h1>
        <div id="menubar_hdr"><span></span><span></span><span></span></div>
        <div id="header-icon">
          <a href="https://x.com/NotEqual0?ref_src=twsrc%5Etfw"
            ><i class="fab fa-twitter"></i
          ></a>
          <a href="https://www.instagram.com/notequalzero/"
            ><i class="fab fa-instagram"></i
          ></a>
          <a href="https://youtu.be/qLqRm1QtDg8"
            ><i class="fab fa-youtube"></i
          ></a>
          <a href="https://note.com/notequalzero"
            ><img src="images/notelogo.jpg" alt="Note"
          /></a>
        </div>
      </header>

      <main>
        <section>
          <h2>お問い合わせ</h2>

          <form id="contactForm">
            <table class="ta1">
              <tr>
                <th>お名前※</th>
                <td>
                  <input
                    type="text"
                    name="name"
                    id="name"
                    size="30"
                    class="ws"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>メールアドレス※</th>
                <td>
                  <input
                    type="email"
                    name="email"
                    id="email"
                    size="30"
                    class="ws"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>お問い合わせ詳細※</th>
                <td>
                  <textarea
                    name="details"
                    id="details"
                    cols="30"
                    rows="10"
                    class="wl"
                    required
                  ></textarea>
                </td>
              </tr>
            </table>
            <p class="btn">
              <input
                type="button"
                value="内容を確認する"
                onclick="showConfirm()"
              />
            </p>
          </form>
        </section>
      </main>

      <div id="menubar">
        <nav>
          <ul>
            <li><a href="index">HOME</a></li>
            <li><a href="company">COMPANY</a></li>
            <li><a href="works">BUSINESS</a></li>
            <li>
              <a href="https://recruiting.web-notequalzero.com">JOB OFFER</a>
            </li>
            <li class="current"><a href="contact">CONTACT</a></li>
          </ul>
        </nav>
      </div>

      <footer>
        <small
          >Copyright&copy;
          <a href="index">NotEqualZero(≠0)Inc. All Rights Reserved。</a></small
        >
      </footer>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Firebaseの設定 -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";

      const firebaseConfig = {
        apiKey: "AIzaSyB9IVZ-FFo6PgcGVvjbFLo1sHPBEixAcy4",
        authDomain: "nez-website.firebaseapp.com",
        projectId: "nez-website",
        storageBucket: "nez-website.appspot.com",
        messagingSenderId: "452672181530",
        appId: "1:452672181530:web:0b21deb55ad13cf05748a3",
        measurementId: "G-8JK0CF7KLG",
      };

      const app = initializeApp(firebaseConfig);

      let contactData = {};

      window.showConfirm = function showConfirm() {
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        const details = document.getElementById("details").value;

        if (name && email && details) {
          contactData = { name, email, details };

          const confirmHtml = `
                        <h2>確認画面</h2>
                        <table class="ta1">
                        <tr>
                        <th width="150">お名前</th>
                        <td>${name}</td>
                        </tr>
                        <tr>
                        <th width="150">メールアドレス</th>
                        <td>${email}</td>
                        </tr>
                        <tr>
                        <th>お問い合わせ内容</th>
                        <td>${details.replace(/\n/g, "<br>")}</td>
                        </tr>
                        </table>
                        <p class="btn">
                        <input type="button" value="送信する" onclick="sendToFirestore()">
                        &nbsp;
                        <input type="button" value="戻る" onclick="showForm()">
                        </p>
                        `;

          document.querySelector("main section").innerHTML = confirmHtml;
        } else {
          alert("すべての必須フィールドを入力してください。");
        }
      };

      window.showForm = function showForm() {
        location.reload();
      };

      window.sendToFirestore = async function sendToFirestore() {
        const { name, email, details } = contactData;

        try {
          console.log("Sending data to Firestore:", { name, email, details });

          await fetch("https://YOUR_CLOUD_FUNCTIONS_URL/limitDailyWrites", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ name, email, details }),
          });

          alert("お問い合わせ内容が送信されました。");
          window.location.href = "contact.html";
        } catch (error) {
          console.error("Error sending data to Firestore: ", error);
          alert(`送信中にエラーが発生しました: ${error.message}`);
        }
      };
    </script>

    <div class="pagetop">
      <a href="#"><i class="fas fa-angle-double-up"></i></a>
    </div>
  </body>
</html>
